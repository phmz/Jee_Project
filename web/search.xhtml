<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>login</title>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <link href = "//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel = "stylesheet"></link>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap.tagsinput/0.4.2/bootstrap-tagsinput.css" />
        <script src="//cdn.jsdelivr.net/bootstrap.tagsinput/0.4.2/bootstrap-tagsinput.min.js"></script>
        <script src="bootstrap/js/typeahead.bundle.js"></script>
    </h:head>
    <h:body>
        <h:form id="tags-form" class="form-horizontal">
            <br/>
            <div class="form-group">
                <label class="col-xs-3 control-label">Keywords</label>
                <div class="col-xs-8">
                    <input class="tagsinput-typeahead" type="text" id="tags-form:keywords" name="tags-form:keywords" />
                </div>
            </div>
            <script>
                var tags = #{requestBean.possibleTags};
                $('.tagsinput-typeahead').tagsinput({
                    typeahead: {
                        source: tags.map(function (item) {
                            return item.name;
                        }),
                        afterSelect: function () {
                            this.$element[0].value = '';
                        }
                    }
                });
            </script>
            <div class="form-group">
                <label class="col-xs-3 control-label">Department</label>
                <div class="dropdown col-xs-8">
                    <h:selectOneMenu id="departmentmenu" value="#{requestBean.department}" style="width:150px" class="dropbtn">
                        <f:selectItem itemLabel="Select Department" itemValue="" noSelectionOption="true" class="dropdown-content" />
                        <f:selectItems value="#{departement.departments}" var="departmentlabel" itemLabel="#{departmentlabel.name}"/>
                        <f:ajax listener="#{requestBean.stateChangeListener}" render="citymenu" />
                    </h:selectOneMenu>
                </div>
            </div>
            
            <div class="form-group">
                <label class="col-xs-3 control-label">City</label>
                <div class="dropdown col-xs-8">
                    <h:selectOneMenu id="citymenu" value="#{requestBean.city}" style="width:150px" class="dropbtn">
                        <f:selectItem itemLabel="Select City" itemValue="" noSelectionOption="true" class="dropdown-content" />
                        <f:selectItems value="#{requestBean.citys}" />
                    </h:selectOneMenu>
                </div>
            </div>
            <br></br>
            <br></br>
            <div class="form-group">
                <div class="col-xs-1 col-xs-offset-3">
                    <p:commandButton update="datatable" class="form-control btn btn-search" actionListener="#{requestBean.addTagToRequest()}" value="Search" type="submit">
                     <f:ajax render="formId"/>
                    </p:commandButton>
                                    
                </div>
            </div>
            
            <p:dataTable id="datatable" var="install" value="#{requestBean.installationList}" rows="10"
                         paginator="true"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="5,10,15"
                         widgetVar="datatable">
                <f:facet name="header">                    
                    <p:outputPanel>
                    <h:outputText value="Search all fields:" />
                        <p:inputText id="globalFilter" onkeyup="PF('datatable').filter()" style="width:150px" placeholder="Enter keyword"/>
                    </p:outputPanel>
                </f:facet>
                <p:column headerText="Nom" filterBy="#{install.insNom}" sortBy="#{install.insNom}" filterMatchMode="contains">
                    <h:outputText value="#{install.insNom}" />
                </p:column>
                
                <p:column headerText="Voie" filterBy="#{install.insLibelleVoie}" sortBy="#{install.insLibelleVoie}" filterMatchMode="contains">
                    <h:outputText value="#{install.insNoVoie} #{install.insLibelleVoie}" />
                </p:column>
                
                <p:column headerText="Code Postal" filterBy="#{install.insCodePostal}" sortBy="#{install.insCodePostal}" filterMatchMode="contains">
                    <h:outputText value="#{install.insCodePostal}" />
                </p:column>
                
                <p:column headerText="Commune" filterBy="#{install.comInsee.comLib}" sortBy="#{install.comInsee.comLib}" filterMatchMode="contains">
                    <h:outputText value="#{install.comInsee.comLib}" />
                </p:column>
 
                <!--<p:column headerText="Place de parking" filterBy="#{install.insNbPlaceParking}" sortBy="#{install.insNbPlaceParking}" filterMatchMode="contains">
                    <h:outputText value="#{install.insNbPlaceParking}" />
                </p:column>-->

            </p:dataTable>                       
        </h:form>
        <link rel="stylesheet" type="text/css" href="resources/css/search.css"></link>
        <h:outputStylesheet library="css" name="search.css"  />                               
    </h:body>


</html>